<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Daddy Dashboard</title>

  <!-- 🔒 iOS Standalone Mode -->
  <meta name="apple-mobile-web-app-capable" content="yes" />

  <!-- 📦 Manifest and Icon -->
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icon.png" />
  <link rel="icon" href="icon.png" type="image/png" />

  <!-- 💅 Styles -->
  <link rel="stylesheet" href="../assets/styles.css" />
</head>
<body>
  <h1>Welcome to Daddy Dashboard</h1>

  <!-- 🛎️ Notification Trigger Button -->
  <button onclick="requestNotificationPermission()">Enable Notifications</button>

  <!-- 🔧 Dashboard Content -->
  <div id="employee-container"></div>

  <!-- 🧠 Script Block -->
  <script>
    // 🔧 Service Worker Registration
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(reg => console.log('Service Worker registered:', reg))
        .catch(err => console.error('Service Worker registration failed:', err));
    }

    // 🔔 Notification Permission Request (gesture-triggered)
    function requestNotificationPermission() {
      if ("Notification" in window) {
        Notification.requestPermission().then(permission => {
          if (permission === "granted") {
            logAudit("Push notifications enabled.", "general");
          } else {
            logAudit("Push notifications denied or dismissed.", "general");
          }
        });
      }
    }

    // 🧠 Page Load Logic
    window.onload = () => {
      detectMasterToken();
      renderEmployees();
      // Do NOT auto-trigger notification permission here — iOS blocks it
    };

    // 🧾 Placeholder Functions
    function detectMasterToken() {
      console.log("Master token detected.");
    }

    function renderEmployees() {
      document.getElementById("employee-container").innerText = "Employee data goes here.";
    }

    function logAudit(message, category) {
      console.log(`[Audit - ${category}]: ${message}`);
    }
  </script>
</body>
</html>
